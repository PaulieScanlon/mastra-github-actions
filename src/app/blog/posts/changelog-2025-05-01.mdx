---
title: Mastra Changelog 2025-05-01
publishedAt: "2025-05-01"
summary: "Mastra's latest updates: vNext workflows, MongoDB vectorDB provider, Streamable HTTP MCP transport, and more."
author: "Shane Thomas"
draft: false
categories: "changelogs"
---

Our latest release features major workflow updates, support for MongoDB, support for the newest MCP transport type, and more.

## vNext workflows: the next generation of Mastra workflows

In case you missed it in ourÂ [changelog](https://mastra.ai/blog/changelog-2025-04-24#vnext-workflows-new-control-flow-multi-engine-workflows-and-more)Â from last week, weâ€™ve given workflowsÂ [a major overhaul](https://github.com/mastra-ai/mastra/tree/main/packages/core/src/workflows/vNext)Â based on user feedback. On Wednesday we releasedÂ **`vNext`**Â workflows in alpha; now, weâ€™re releasingÂ **`vNext`**Â in stable (0.9.1).

vNext will feature several improvements that largely address 3 big needs: stronger control flow, better type safety, and multi-engine support.

Hereâ€™s a code sample that shows the new syntax:

```tsx
workflow
  .then(fetchWeather)
  .branch([
    [
      async ({ inputData }) => {
        return inputData?.rainChance > 0.5;
      }, // conditional
      planIndoorActivities, // step or workflow
    ],
    [
      async ({ inputData }) => {
        return inputData?.rainChance <= 0.5;
      },
      planActivities, // step or workflow
    ],
  ])
  .commit();
```

Here are some of the biggest improvements weâ€™ve made around control flows:

- Nested Workflows are now first-class citizens and the first primitive to reach for when composing any nested control flows or circular execution structures
- Looping (**`while`**Â orÂ **`until`**) accepts a single Step or Workflow and repeats until conditions are met
- **`.branch()`**Â replaces if/else, providing clearer conditional paths. Each truthy condition executes in parallel. AndÂ **`.parallel()`**Â for condition-less parallel execution path branching.
  - Branching creates a visual mental model of forking paths in a tree, which accurately represents workflow conditions
- **`.then()`**Â is now the universal connector (**`.step()`**Â has been retired)
- Mastra primitives, like agents and tools, can be transformed to workflow steps usingÂ **`createStep()`**
- We no longer have theÂ **`.after()`**Â command; users reported the loop-back syntax was hard to reason about. Now, in vNext, branching and dependencies are encapsulated in child workflows and explicit control flow changes.

### Transitioning from legacy to vNext

Next week, weâ€™ll be switching over to vNext during our next official release on May 6th, 2025. That means importing fromÂ **`@mastra/core/workflows`**Â will give you theÂ **`vNext`**Â workflows.

If youâ€™re using the legacy workflow system, and you want to upgrade Mastra versions but youâ€™re not yet ready to switch over, you can use theÂ **`legacy`**Â import and prefix, eg:

```tsx
import { Step, Workflow } from '@mastra/core/workflows/legacy'
import { Mastra } from '@mastra/core/mastra'
const step1 = new Step(...)
const workflow = new Workflow(...).step(step1).commit();

const mastra = new Mastra({
  // registering legacy workflows
  legacy_workflows: {
    myWorkflow: workflow
  }
})

// accessing the workflow through the mastra class:
mastra.legacy_getWorkflow('myWorkflow')
```

Read the full [blogpost](https://mastra.ai/blog/vNext-workflows) to learn all about vNext. Full docs [here](https://mastra.ai/en/docs/workflows-vnext/overview).

## New vectorDB provider: MongoDB

We've [added](https://github.com/mastra-ai/mastra/pull/3823) MongoDB as a vector databaseÂ provider, giving you another solid option for storing and retrieving vector embeddings in your applications. Mastra now has 12 vector DB integrations including Postgres/pgvector, libsql, Chroma, and many others.

MongoDB has beenÂ pushing theÂ envelope with vector search since early 2023 and weâ€™re happy that you can now use MongoDBâ€™s vector capabilities directly with Mastra.

## Streamable HTTP MCP transport

We now [support](https://github.com/mastra-ai/mastra/pull/3834) Streamable HTTP as an MCP transport.

Previously, there were two ways to create an MCP server:

1. Stdio transport (using a program running on your computer for the MCP tools)
2. SSE transport (a web server hosted somewhere where you connect via URL)

MCP [deprecated](https://github.com/modelcontextprotocol/modelcontextprotocol/pull/206) the latter (SSE) and replaced it with Streamable HTTP. We now support this new Streamable HTTP MCP transport type.

## Other updates

- We recently added Docker as a new MCP registry option to The MCP registry registry
- Weâ€™re hosting the very first Mastra virtual hackathon, [MASTRA.BUILD](https://mastra.ai/hackathon), from May 12th-16h. Cash prizes and tons of hands-on building. [Find the schedule & registration on our Lu.ma](https://lu.ma/x637wtj0).

[Find the full release log for the past week here](https://github.com/mastra-ai/mastra/releases/tag/%40mastra%2Fcore%400.9.1).

Happy building and see you next weekâ€¦ ğŸš€
